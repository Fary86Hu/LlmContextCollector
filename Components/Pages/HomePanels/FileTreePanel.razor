<div class="panel panel-left">
    <div class="toolbar">
        <button @onclick="SelectProjectFolder">Projekt Mappa...</button>
        <input type="text" class="path-display" placeholder="Nincs mappa kiv√°lasztva" @bind="AppState.ProjectRoot" @bind:event="oninput" />
    </div>
    <div class="toolbar">
        <button @onclick="OnAzureDevOpsAttach" title="Azure DevOps Work Item-ek let√∂lt√©se/kezel√©se">ADO Let√∂lt√©s</button>
        @if (AppState.IsSemanticIndexBuilding)
        {
            <button style="margin: 0 5px;" disabled>Indexel√©s folyamatban...</button>
        }
        else
        {
            <button @onclick="OnStartIndexingCode" style="margin: 0 2px;">Index (K√≥d)</button>
            @if (AppState.AdoDocsExist)
            {
                <button @onclick="OnStartIndexingAdo" style="margin: 0 2px;">Index (ADO)</button>
            }
        }
    </div>
    <div class="toolbar">
        <label for="history-select" style="white-space: nowrap; margin-right: 5px;">El≈ëzm√©nyek:</label>
        <select id="history-select" @onchange="LoadSelectedHistory" style="flex-grow: 1;">
            <option value="-1" selected>V√°lassz egy el≈ëzm√©nyt...</option>
            @foreach (var (entry, index) in AppState.HistoryEntries.Select((entry, index) => (entry, index)))
            {
                <option value="@index">@FormatHistoryEntry(entry)</option>
            }
        </select>
    </div>
    <div class="toolbar">
        <input type="text" placeholder="Keres√©s..." style="flex-grow: 1;" @bind="AppState.SearchTerm" @bind:event="oninput" @onkeyup="HandleSearchKeyup" />
        <label style="font-size: 0.8em; margin: 0 5px;"><input type="checkbox" @bind="AppState.SearchInContent" /> Tartalomban</label>
        <button @onclick="ToggleFilter" 
                disabled="@(string.IsNullOrWhiteSpace(AppState.SearchTerm) && !_isFiltered)" 
                class="icon-btn" 
                title="@(_isFiltered ? "Sz≈±r√©s t√∂rl√©se" : "Sz≈±r√©s")">
            @if (_isFiltered)
            {
                <span>üö´</span>
            }
            else
            {
                <span>üîç</span>
            }
        </button>
        <button @onclick="FindPrevious" class="icon-btn" disabled="@(string.IsNullOrWhiteSpace(AppState.SearchTerm))" title="El≈ëz≈ë tal√°lat">‚ñ≤</button>
        <button @onclick="() => FindNext(false)" class="icon-btn" disabled="@(string.IsNullOrWhiteSpace(AppState.SearchTerm))" title="K√∂vetkez≈ë tal√°lat">‚ñº</button>
        <button @onclick="ClearSearch" class="icon-btn clear-btn" title="T√∂rl√©s">&times;</button>
    </div>
    <div class="tree-view-container" @oncontextmenu="e => OnShowTreeContextMenu.InvokeAsync(e)" @oncontextmenu:preventDefault>
        @if (AppState.FileTree.Any())
        {
            foreach (var node in AppState.FileTree)
            {
                <FileTreeNodeView Node="node" OnNodeClick="HandleNodeClick" />
            }
        }
        else
        {
            <div style="padding: 10px; color: #888;">Nincs megjelen√≠thet≈ë f√°jl. V√°lasszon mapp√°t √©s alkalmazza a sz≈±r≈ëket.</div>
        }
    </div>
</div>